---
title: 21장. 소리치는 아키텍처
author: Jandari
date: 2022-05-13 23:30:00 +09:00
categories: [DDD, 클린 아키텍처 소프트웨어 구조와 설계의 원칙, 5부 아키텍처]
tags: [DDD, CleanArchitecture]
math: true
mermaid: true
---

# 소개

![image](/assets/img/post/2022-05-13-PPPCleanArchitecture_ch21/1.jpg)

클린아키텍처: 소프트웨어 구조와 설계의 원칙 책을 읽고 정리하며 소감을 적는 포스트입니다.

# 소리치는 아키텍처

건물의 청사진을 살펴보고 있다고 상상해보자. 아키텍트가 작성한 건물에 대한 일련의 계획을 보여주고 있다.

계획서가 사람이 거주 할 주택이라면 정문, 거실로 연결되는 현관, 그리고 부엌 가족방 등이 있을 가능성이 높다. 이러한 계획서를 보면 이건 한 가족이 사는 주택이라는 느낌을 받을 것이다. 다시 말해, 아키텍처가 `난 집이야!!`라고 소리칠 것이다.

자, 여러분의 애플리케이션 아키텍처는 뭐라고 소리치는가? 상위 수준의 디렉터리 구조, 최상위 패키지에 담긴 소스 파일을 볼 때, 이 아키텍처는 `"헬스케어 시스템이야!"`, `"재고 관리 시스템이야!"`라고 소리치는가??

아니면 `"스프링이야!"`, `"ASP야!!"`라고 소리치는가??

## 아키텍처의 테마

이바 야콥슨(Ivar Jacobson)이 쓴 `Object Oriented Software Engineering`이라는 책의 부제가 `유스케이스 주도 접근법(Use Case Driven Approach)`이다.

야콥슨은 소프트웨어 아키텍처는 시스템의 유스케이스를 지원하는 구조라고 지적했다. 주택이나 도서관의 계획서가 해당 건축물의 유스케이스에 대해 소리치는 것처럼, 소프트웨어 애플리케이션의 아키텍처도 애플리케이션의 유스케이스에 대해 소리쳐야 한다.

아키텍처는 프레임워크에 대한 것이 아니다. 아키텍처를 프레임워크로부터 제공받아서는 절대 안 된다.

아키텍처를 프레임워크 중심으로 만들어버리면 유스케이스가 중심이 되는 아키텍처는 절대 나올 수 없다.

## 아키텍처의 목적

좋은 아키텍처는 유스케이스를 그 중심에 두기 때문에, 프레임워크나 도구, 환경에 전혀 구애받지 않고 유스케이스를 지원하는 구조를 아무런 문제 없이 기술할 수 있다.

좋은 소프트웨어 아키텍처는 프레임워크, 데이터베이스, 웹 서버, 그리고 여타 개발 환경 문제나 도구에 대해서는 결정을 미룰 수 있도록 만든다.

좋은 아키텍처는 유스케이스에 중점을 두며, 지엽적인 관심사에 대한 결합은 분리시킨다.

## 하지만 웹은??

웹은 아키텍처일까?? 시스템이 웹을 통해 전달된다는 사실이 시스템의 아키텍처에 영향을 주는가? 당연히 아니다! 웹은 전달 메커니즘(입출력 장치)이며, 애플리케이션 아키텍처에서도 그와 같이 다뤄야 한다.

실제 애플리케이션을 웹으로 전달할지 여부는 미루어야 할 결정사항 중 하나다. 시스템 아키텍처는 시스템이 어떻게 전다로딜지에 대해 가능하다면 아무것도 몰라야 한다.

시스템을 콘솔 앱, 웹 앱, 리크 클라이언트 앱, 심지어 웹서비스 앱으로도 전달할 수 있어야 한다.

## 프레임워크는 도구일 뿐, 삶의 방식은 아니다.

프레임워크는 매우 강력하고 상당히 유용할 수 있다. 프레임워크 제작자는 자신이 만든 프레임워크를 매우 깊이 신뢰하곤 한다. 프레임워크를 사용하는 방식을 보여주면서, 흔히 모든 것을 아우르는, 어디에나 스며드는, "프레임워크가 모든 것을 하게하자"라는 태도를 취한다.

`이는 우리가 취하고 싶은 태도가 아니다`

어떻게 하면 아키텍처를 유스케이스에 중점을 둔 채 그대로 보전할 수 있을지를 생각하라. 프레임워크는 아키텍처의 중심을 차지하는 일을 막을 수 있는 전략을 개발하라.

## 테스트하기 쉬운 아키텍처

아키텍처가 유스케이스를 최우선으로 한다면, 그리고 프레임워크와는 적당한 거리를 둔다면, 프레임워크를 전혀 준비하지 않더라도 필요한 유스케이스 전부에 대해 단위 테스트를 할 수 있어야 한다.

테스트를 돌리는 데 웹 서버가 반드시 필요한 상황이 되어서는 안 된다. 데이터베이스가 반드시 연결되어 있어야만 테스트를 돌리 수 잇어서도 안 된다.

엔티티 객체는 반드시 오래 된 방식의 간단한 객체(plain old object)여야 하며, 프레임워크나 데이터베이스, 또는 여타 복잡한 것들에 의존해서는 안 된다.

최종적으로, 프레임워크로 인한 어려움을 겪지 않고도 반드시 이 모두를 있는 그대로 테스트 할 수 있어야 한다.

## 결론

아키텍처는 시스템을 이야기해야 하며, 시스템에 적용한 프레임워크에 대해 이야기해서는 안 된다.

새로 합류한 프로그래머는 시스템이 어떻게 전달될지 알지 못한 상태에서도 시스템의 모든 유스케이스를 이해할 수 있어야 한다.

언젠가 이들은 당신을 찾아와서 이렇게 말할 것이다.

"모델처럼 보이는 것들을 확인했습니다. 그런데 뷰와 컨트롤러는 어디에 있죠?"

그러면 당신은 이와 같이 답해야 한다.

"아, 그것은 세부사항이므로 당장슨 고려할 필요가 없습니다. 나중에 결정 할 겁니다."